## í«ë°ì´ì¦ˆ
<img alt="header" width="1024" src="https://github.com/zzikbu/PetDays/blob/main/readme_assets/header.png?raw=true">

<p align="center">
  <a href="https://apps.apple.com/kr/app/%ED%8E%AB%EB%8D%B0%EC%9D%B4%EC%A6%88/id6738037038">
    <img alt="app_store" height="60" src="https://raw.githubusercontent.com/zzikbu/PetDays/main/readme_assets/app_store.png">
  </a>
  <a href="https://play.google.com/store/apps/details?id=com.devmoichi.petdays">
    <img alt="play_store" height="60" src="https://raw.githubusercontent.com/zzikbu/PetDays/main/readme_assets/play_store.png">
  </a>
</p>

## ëª©ì°¨
- [í”„ë¡œì íŠ¸ ì†Œê°œ](#í”„ë¡œì íŠ¸-ì†Œê°œ)
- [ê°œë°œ ê¸°ê°„](#ê°œë°œ-ê¸°ê°„)
- [ì£¼ìš” ê¸°ëŠ¥](#ì£¼ìš”-ê¸°ëŠ¥)
- [ê¸°ìˆ  ìŠ¤íƒ](#ê¸°ìˆ -ìŠ¤íƒ)
- [ê¸°íš ë° ë””ìì¸](#ê¸°íš-ë°-ë””ìì¸)
- [ê¸°ëŠ¥ ì‹¤í–‰ í™”ë©´](#ê¸°ëŠ¥-ì‹¤í–‰-í™”ë©´)
- [ì£¼ìš” ê¸°ìˆ ](#ì£¼ìš”-ê¸°ìˆ )
  <br/><br/>

## í”„ë¡œì íŠ¸ ì†Œê°œ
**1ì¸ ê¸°íš / ë””ìì¸ / ê°œë°œ**<br>

ë°˜ë ¤ë™ë¬¼ì˜ ì„±ì¥ì¼ê¸°, ì§„ë£Œê¸°ë¡, ì‚°ì±…ê¸°ë¡ì„ í•œê³³ì— ë‹´ì•„ ë³´ê´€í•˜ê³  ê³µìœ í•  ìˆ˜ ìˆëŠ” ëª¨ë°”ì¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤.
<br/><br/>

## ê°œë°œ ê¸°ê°„
- **ê¸°íš & ë””ìì¸:** 2024.07.29 ~ 2024.08.28 _(ì•½ 1ê°œì›”)_
- **ê¸°ëŠ¥ ê°œë°œ & ë°°í¬:** 2024.08.14 ~ 2024.12.01 _(ì•½ 5ê°œì›”)_
- **ë¦¬íŒ©í† ë§ & ìœ ì§€ë³´ìˆ˜:** 2024.12.01 ~ _(í˜„ì¬ ì§„í–‰ ì¤‘)_  
  <br>

## ì£¼ìš” ê¸°ëŠ¥
1. **ë°˜ë ¤ë™ë¬¼:** ë°˜ë ¤ë™ë¬¼ì˜ ê¸°ë³¸ ì •ë³´ë¥¼ ë“±ë¡í•˜ê³ , í•¨ê»˜í•œ ì†Œì¤‘í•œ ì‹œê°„ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

2. **ì„±ì¥ì¼ê¸°:** ë°˜ë ¤ë™ë¬¼ê³¼ì˜ íŠ¹ë³„í•œ ìˆœê°„ì„ ì‚¬ì§„ê³¼ ê¸€ë¡œ ê¸°ë¡í•´ ì¶”ì–µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

3. **ì§„ë£Œê¸°ë¡:** ë³‘ì› ë°©ë¬¸ ê¸°ë¡ì„ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

4. **ì‚°ì±…:** ì‚°ì±… ì‹œê°„,ê±°ë¦¬ì™€ ê²½ë¡œë¥¼ ê¸°ë¡í•´ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

5. **í”¼ë“œ:** ê³µê°œëœ ì„±ì¥ì¼ê¸°ë¥¼ í†µí•´ ë‹¤ë¥¸ ë°˜ë ¤ì¸ë“¤ê³¼ ê²½í—˜ì„ ê³µìœ í•˜ê³  ì¢‹ì•„ìš”ë¥¼ í†µí•´ ê³µê°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
   <br/><br/>

## ê¸°ìˆ  ìŠ¤íƒ
- **ì–¸ì–´:** `Dart`
- **í”„ë ˆì„ì›Œí¬:** `Flutter`
- **ì•„í‚¤í…ì³**: `MVVM`<br>
  <img alt="architecture" height="280" src="https://github.com/zzikbu/PetDays/blob/main/readme_assets/architecture.png?raw=true">

- **ì‚¬ìš©í•œ íŒ¨í‚¤ì§€:**
  - Firebase: `firebase_core`, `firebase_auth`, `cloud_firestore`, `firebase_storage`, `google_sign_in`
  - State Management: `provider`, `state_notifier`, `flutter_state_notifier`
  - Location: `geolocator`, `google_maps_flutter`
  - UI/UX: `carousel_slider`, `smooth_page_indicator`, `flutter_svg`, `extended_image`
  - Util:  `image_picker`, `permission_handler`, `flutter_native_splash`, `uuid`, `string_validator`, `package_info_plus`, `webview_flutter`
    <br/><br/>

## ê¸°íš ë° ë””ìì¸
### [ğŸ”— ê¸°íš ë° ë””ìì¸ Figma ğŸ”—](https://www.figma.com/design/LbVM8DvEcGfaR47cfpLk0c/%ED%8E%AB%EB%8D%B0%EC%9D%B4%EC%A6%88_%EB%94%94%EC%9E%90%EC%9D%B8?node-id=3-219&t=x3TuifRTAZvSPb8Z-1)

| IA                                                           | FlowChart                                                    |
|:------------------------------------------------------------:|:------------------------------------------------------------:|
| <img alt="ia" height="309" src="https://github.com/zzikbu/PetDays/blob/main/readme_assets/plan_design/ia.png?raw=true"> | <img alt="flowchart" height="309" src="https://github.com/zzikbu/PetDays/blob/main/readme_assets/plan_design/flowchart.png?raw=true"> |

| í™ˆ                                                            | ë°˜ë ¤ë™ë¬¼ ìƒì„¸ë³´ê¸°                                                    | í”¼ë“œ í™ˆ                                                         | ì„±ì¥ì¼ê¸° ìƒì„¸ë³´ê¸°                                                    |
|:------------------------------------------------------------:|:------------------------------------------------------------:|:------------------------------------------------------------:|:------------------------------------------------------------:|
| <img alt="home" width="144" src="https://github.com/zzikbu/PetDays/blob/main/readme_assets/plan_design/home.png?raw=true"> | <img alt="pet_detail" width="190" src="https://github.com/zzikbu/PetDays/blob/main/readme_assets/plan_design/pet_detail.png?raw=true"> | <img alt="feed_home" width="178" src="https://github.com/zzikbu/PetDays/blob/main/readme_assets/plan_design/feed_home.png?raw=true"> | <img alt="diary_detail" width="172" src="https://github.com/zzikbu/PetDays/blob/main/readme_assets/plan_design/diary_detail.png?raw=true"> |
| ì‚°ì±… í™ˆ                                                         | ì‚°ì±… ìƒì„¸ë³´ê¸°                                                      | ì‚°ì±… ì§€ë„ íŠ¸ë˜í‚¹                                                    |                                                              |
| <img alt="walk_home" width="174" src="https://github.com/zzikbu/PetDays/blob/main/readme_assets/plan_design/walk_home.png?raw=true"> | <img alt="walk_detail" width="174" src="https://github.com/zzikbu/PetDays/blob/main/readme_assets/plan_design/walk_detail.png?raw=true"> | <img alt="walk_map" width="174" src="https://github.com/zzikbu/PetDays/blob/main/readme_assets/plan_design/walk_map.png?raw=true"> |                                                              |
<br/>

## ê¸°ëŠ¥ ì‹¤í–‰ í™”ë©´

| ë¡œê·¸ì¸                                                          | íšŒì›ê°€ì…                                                         | í™ˆ                                                            | ë°˜ë ¤ë™ë¬¼ ì¶”ê°€                                                      |
|:------------------------------------------------------------:|:------------------------------------------------------------:|:------------------------------------------------------------:|:------------------------------------------------------------:|
| <img alt="signin" width="180" src="https://github.com/zzikbu/PetDays/blob/main/readme_assets/gif/signin.gif?raw=true"> | <img alt="signup" width="180" src="https://github.com/zzikbu/PetDays/blob/main/readme_assets/gif/signup.gif?raw=true"> | <img alt="home" width="180" src="https://github.com/zzikbu/PetDays/blob/main/readme_assets/gif/home.gif?raw=true"> | <img alt="pet" width="180" src="https://github.com/zzikbu/PetDays/blob/main/readme_assets/gif/pet.gif?raw=true"> |
| ì„±ì¥ì¼ê¸°                                                         | ì§„ë£Œê¸°ë¡                                                         | ì‚°ì±…                                                           | í”¼ë“œ / ì¢‹ì•„ìš”                                                     |
| <img alt="diary" width="180" src="https://github.com/zzikbu/PetDays/blob/main/readme_assets/gif/diary.gif?raw=true"> | <img alt="medical" width="180" src="https://github.com/zzikbu/PetDays/blob/main/readme_assets/gif/medical.gif?raw=true"> | <img alt="walk" width="180" src="https://github.com/zzikbu/PetDays/blob/main/readme_assets/gif/walk.gif?raw=true"> | <img alt="feed" width="180" src="https://github.com/zzikbu/PetDays/blob/main/readme_assets/gif/feed.gif?raw=true"> |
| ì‹ ê³  / ì°¨ë‹¨                                                      | ë‹‰ë„¤ì„ ë³€ê²½                                                       | í”„ë¡œí•„ ì´ë¯¸ì§€ ë³€ê²½ / ì‚­ì œ                                              | ê³µê°œí•œ ì„±ì¥ì¼ê¸°                                                     |
| <img alt="report_block" width="180" src="https://github.com/zzikbu/PetDays/blob/main/readme_assets/gif/report_block.gif?raw=true"> | <img alt="nickname" width="180" src="https://github.com/zzikbu/PetDays/blob/main/readme_assets/gif/nickname.gif?raw=true"> | <img alt="profile_image" width="180" src="https://github.com/zzikbu/PetDays/blob/main/readme_assets/gif/profile_image.gif?raw=true"> | <img alt="open" width="180" src="https://github.com/zzikbu/PetDays/blob/main/readme_assets/gif/open.PNG?raw=true"> |
| ì¢‹ì•„ìš”í•œ ì„±ì¥ì¼ê¸°                                                    |                                                              |                                                              |                                                              |
| <img alt="like" width="180" src="https://github.com/zzikbu/PetDays/blob/main/readme_assets/gif/like.PNG?raw=true"> |                                                              |                                                              |                                                              |
<br/>

## ì£¼ìš” ê¸°ìˆ 
### âœ… Providerì™€ StateNotifierë¥¼ í™œìš©í•œ íš¨ìœ¨ì ì¸ ìƒíƒœ ê´€ë¦¬
* ê¸°ì¡´ `ChangeNotifier`ì˜ í•œê³„ë¥¼ ë³´ì™„í•˜ê³ , ë” íš¨ìœ¨ì ì¸ ìƒíƒœ ê´€ë¦¬ë¥¼ ìœ„í•´ `StateNotifier`ë¥¼ ë„ì…í–ˆìŠµë‹ˆë‹¤.

* `StateNotifier` ì‚¬ìš©í•œ ì£¼ìš” ê°œì„ ì 
  - **Immutable ê¸°ë°˜ì˜ ìƒíƒœ ê´€ë¦¬**: ìƒíƒœ ë³€ê²½ ì‹œ ìƒˆë¡œìš´ ìƒíƒœ ê°ì²´ë¥¼ ìƒì„±í•˜ì—¬ ë³€ê²½ ê³¼ì •ì„ ëª…í™•íˆ ì¶”ì 
  - **íƒ€ì… ì•ˆì „ì„± ê°•í™”**: ì—„ê²©í•œ ìƒíƒœ íƒ€ì… ì •ì˜ë¥¼ í†µí•œ ëŸ°íƒ€ì„ ì—ëŸ¬ ë°©ì§€
  - **ìƒíƒœì˜ Status êµ¬ë¶„**: ê° ìƒíƒœì˜ Statusë¥¼ ì§ê´€ì ìœ¼ë¡œ ì•Œ ìˆ˜ ìˆë„ë¡ init, submitting, fetching ë“±ìœ¼ë¡œ êµ¬ì²´ì ìœ¼ë¡œ ì •ì˜
```dart
// Status ì •ì˜
enum MedicalStatus { init, submitting, fetching, success, error }

// ë¶ˆë³€ ìƒíƒœ í´ë˜ìŠ¤ ì •ì˜
class MedicalState {
  final MedicalStatus medicalStatus;
  final List<MedicalModel> medicalList;

  const MedicalState({
    required this.medicalStatus, 
    required this.medicalList
  });
  
  MedicalState copyWith({
    MedicalStatus? medicalStatus, 
    List<MedicalModel>? medicalList
  }) {
    return MedicalState(
      medicalStatus: medicalStatus ?? this.medicalStatus,
      medicalList: medicalList ?? this.medicalList,
    );
  }
}

// Provider êµ¬í˜„
class MedicalProvider extends StateNotifier<MedicalState> with LocatorMixin {
  MedicalProvider() : super(MedicalState.init());

  Future<void> getMedicalList({required String uid}) async {
    try {
      // fetching ìƒíƒœë¡œ ë³€ê²½
      state = state.copyWith(medicalStatus: MedicalStatus.fetching);
      
      // ë°ì´í„° ìš”ì²­ ë¡œì§
      final medicalList = await read<MedicalRepository>().getMedicalList(uid: uid);
      
      // success ìƒíƒœë¡œ ë³€ê²½ ë° medicalList ì—…ë°ì´íŠ¸
      state = state.copyWith(
        medicalList: medicalList,
        medicalStatus: MedicalStatus.success,
      );
    } on CustomException catch (_) {
      // error ìƒíƒœë¡œ ë³€ê²½
      state = state.copyWith(medicalStatus: MedicalStatus.error);
      rethrow;
    }
  }
}

// UIì—ì„œ ìƒíƒœ êµ¬ë… í›„ í™œìš©
Widget build(BuildContext context) {
  final medicalState = context.watch<MedicalState>();
  final isLoading = medicalState.medicalStatus == MedicalStatus.fetching;
  
  return isLoading
    ? CircularProgressIndicator()
    : ListView.builder(
        itemCount: medicalState.medicalList.length,
        itemBuilder: (context, index) => 
          MedicalCard(medicalState.medicalList[index]),
      );
}
```
---
### âœ… Database Batch
- `Batch`ëŠ” ì—¬ëŸ¬ ë°ì´í„°ë² ì´ìŠ¤ ì‘ì—…ì„ í•˜ë‚˜ë¡œ ë¬¶ì–´ ì‹¤í–‰í•˜ë©°, ì‘ì—… ì¤‘ í•˜ë‚˜ë¼ë„ ì‹¤íŒ¨í•˜ë©´ ë¡¤ë°±ë˜ì–´ ë°ì´í„°ì˜ ì¼ê´€ì„±ê³¼ ë¬´ê²°ì„±ì„ ë³´ì¥í•©ë‹ˆë‹¤.

- ì„±ì¥ì¼ê¸° ì‚­ì œ ê¸°ëŠ¥ì—ì„œ ì•„ë˜ ì‘ì—…ì„ `Batch`ë¥¼ í™œìš©í•´ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.<br/>
  â‘  í•´ë‹¹ ë¬¸ì„œì— ì¢‹ì•„ìš”ë¥¼ ëˆ„ë¥¸ ì‚¬ìš©ìë“¤ì˜ likes í•„ë“œì—ì„œ ì„±ì¥ì¼ê¸° ID ì œê±°<br/>
  â‘¡ í•´ë‹¹ ì„±ì¥ì¼ê¸° ë¬¸ì„œ ì‚­ì œ<br/>
  â‘¢ ì‘ì„±ìì˜ diaryCount ê°ì†Œ
- Code<br/>
  ```dart
    WriteBatch batch = firebaseFirestore.batch();

    // ì„±ì¥ì¼ê¸° ì¢‹ì•„ìš” ëˆ„ë¥¸ ì‚¬ìš©ì ì°¾ê¸°
    List<String> likes = await diaryDocRef
        .get()
        .then((value) => List<String>.from(value.data()!['likes']));

    // â‘  í•´ë‹¹ ì‚¬ìš©ìë“¤ì˜ likes í•„ë“œì—ì„œ ì„±ì¥ì¼ê¸° ID ì œê±°  
    likes.forEach((uid) {
      batch.update(firebaseFirestore.collection('users').doc(uid), {
        'likes': FieldValue.arrayRemove([diaryModel.diaryId]),
      });
    });

    // â‘¡ ì„±ì¥ì¼ê¸° ë¬¸ì„œ ì‚­ì œ
    batch.delete(diaryDocRef);

    // â‘¢ ì‘ì„±ìì˜ diaryCount ê°ì†Œ
    batch.update(writerDocRef, {
      'diaryCount': FieldValue.increment(-1),
    });

    // ì‹¤í–‰
    batch.commit();
  ```
---
### âœ… Database Transaction
- `Transaction`ì€ ë°ì´í„° ë³€ê²½ ì‹œ ìë™ ì¬ì‹œë„(ìµœëŒ€ 5íšŒ)ë¥¼ í†µí•´ ëª¨ë“  ì‘ì—…ì´ ì„±ê³µí•˜ê±°ë‚˜ ì‹¤íŒ¨ ì‹œ ëª¨ë‘ ì·¨ì†Œë˜ë„ë¡ í•˜ì—¬ ë™ì‹œ ì‘ì—… ê°„ ë°ì´í„° ì¼ê´€ì„±ì„ ìœ ì§€í•©ë‹ˆë‹¤.

- ì„±ì¥ì¼ê¸° ì¢‹ì•„ìš” ê¸°ëŠ¥ì—ì„œ ì•„ë˜ ì‘ì—…ì„ `Transaction`ì„ í™œìš©í•´ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.<br/>
  â‘  í•´ë‹¹ ì„±ì¥ì¼ê¸°ì˜ likes í•„ë“œì—ì„œ ìœ ì € ID ì¶”ê°€ ë˜ëŠ” ì œê±°<br/>
  â‘¡ í•´ë‹¹ ì„±ì¥ì¼ê¸°ì˜ likeCount ì¦ê°€ ë˜ëŠ” ê°ì†Œ<br/>
  â‘¢ ì¢‹ì•„ìš”ë¥¼ ëˆ„ë¥¸ ìœ ì € ë¬¸ì„œì˜ likes í•„ë“œì— ì„±ì¥ì¼ê¸° ID ì¶”ê°€ ë˜ëŠ” ì œê±°

- Code <br/>
  ```dart
  // ì„±ì¥ì¼ê¸° likesì— ì‚¬ìš©ì IDê°€ ìˆëŠ”ì§€ í™•ì¸
  bool isDiaryContains = diaryLikes.contains(uid);

  transaction.update(diaryDocRef, {
    // â‘  í•´ë‹¹ ì„±ì¥ì¼ê¸° likes ì—…ë°ì´íŠ¸
    'likes': isDiaryContains
        ? FieldValue.arrayRemove([uid])
        : FieldValue.arrayUnion([uid]),
    // â‘¡ ì„±ì¥ì¼ê¸° likeCount ì—…ë°ì´íŠ¸
    'likeCount': isDiaryContains
        ? FieldValue.increment(-1)
        : FieldValue.increment(1),
  });

  // â‘¢ ì¢‹ì•„ìš” ëˆ„ë¥¸ ì‚¬ìš©ìì˜ likes ì—…ë°ì´íŠ¸
  transaction.update(userDocRef, {
    'likes': userLikes.contains(diaryId)
        ? FieldValue.arrayRemove([diaryId])
        : FieldValue.arrayUnion([diaryId]),
  });
  ```
